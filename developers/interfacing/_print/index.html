<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://neurodesk.org/developers/interfacing/><link rel=alternate type=application/rss+xml href=https://neurodesk.org/developers/interfacing/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=https://neurodesk.org/static/favicons/favicon.ico><link rel=apple-touch-icon href=https://neurodesk.org/static/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=https://neurodesk.org/static/favicons/android-192x192.png sizes=192x192><title>Interfacing | Neurodesk</title>
<meta name=description content="Section to describe programmatic interfaces to Neurodesk"><meta property="og:url" content="https://neurodesk.org/developers/interfacing/"><meta property="og:site_name" content="Neurodesk"><meta property="og:title" content="Interfacing"><meta property="og:description" content="Section to describe programmatic interfaces to Neurodesk"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Interfacing"><meta itemprop=description content="Section to describe programmatic interfaces to Neurodesk"><meta itemprop=dateModified content="2025-10-30T11:09:51+10:00"><meta itemprop=wordCount content="730"><meta name=twitter:card content="summary"><meta name=twitter:title content="Interfacing"><meta name=twitter:description content="Section to describe programmatic interfaces to Neurodesk"><link rel=preload href=https://neurodesk.org/scss/main.min.2f0e7dd254a8510650f53c8ffbf7f9af0cc4e0d57d8872fb80c52b2440db9e88.css as=style integrity="sha256-Lw590lSoUQZQ9TyP+/f5rwzE4NV9iHL7gMUrJEDbnog=" crossorigin=anonymous><link href=https://neurodesk.org/scss/main.min.2f0e7dd254a8510650f53c8ffbf7f9af0cc4e0d57d8872fb80c52b2440db9e88.css rel=stylesheet integrity="sha256-Lw590lSoUQZQ9TyP+/f5rwzE4NV9iHL7gMUrJEDbnog=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.8.2 integrity="sha512-l7pkV1dOURFyHCeH8I4fK9lCkQKuqhlsTCqRl3zktifDlB8oTUJ+mJPgYkK9kHpUut8j1iPquTv32t6hvTPv3g==" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-4Z9774J59Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4Z9774J59Y")}</script></head><body class=td-section><header><nav class="td-navbar navbar-expand-xl navbar-dark bg-dark"><div class="container-fluid flex-md-row"><a class=navbar-brand href=https://neurodesk.org/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" viewBox="0 0 560.3 82.7"><defs><style>.st0{isolation:isolate}.st1{fill:#6ba442}.st2{fill:#fff}</style></defs><g class="st0"><path class="st2" d="M30.2 73.4h-9.9v-60h9.8l33.3 44.8V13.4h10.1v60H63.4L30.1 29.1v44.3z"/><path class="st2" d="M85.8 13.4h45l-1.4 10.3-33.8-.2v13.6l20.1-.2v11.4H95.6v13.5H129l1.8 11.6h-45v-60z"/><path class="st2" d="M141.4 13.4h9.9v50.2h28.2V13.4h9.9v51.4c0 1.2-.2 2.3-.7 3.3-.4 1-1.1 2-1.8 2.7-.8.8-1.7 1.4-2.8 1.8-1.1.4-2.2.7-3.3.7h-30.7c-1.2.0-2.3-.2-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7s-.7-2.2-.7-3.3V13.4z"/><path class="st2" d="M244.7 34.8c0 4.6-1.4 7.9-4.3 10-4 2.9-8.4 4.4-13.2 4.4l17.5 24.3h-12.1l-14.7-24h-9.5v24h-8.5V13.4h29.8c10 0 15 4.9 15 14.6v6.8zm-36.3 6h15.2c3.9-.2 6.6-.7 8-1.6 2.6-1.8 3.9-2.9 3.9-3.5V29c0-2.2-.6-3.9-1.7-5-1.4-1.4-3-2.1-4.7-2.1h-20.8v18.9z"/><path class="st2" d="M306.5 59.4c0 4.8-.3 7.7-.6 8.7-.3.9-.9 1.8-1.8 2.8s-1.7 1.3-3.1 1.8c-1.3.5-3.6.7-6.8.7h-27.1c-1.2.0-2.8-.2-5-.6-2.5-.5-3.9-1.1-4.4-1.8-.9-1.5-1.6-2.4-1.8-2.7-.4-.6-.7-3.6-.7-8.7V42.1c0-8.8.0-14.1.2-15.9.0-2.6.3-5 .7-7.4.1-.8.7-1.7 1.7-2.7.6-.7 2.1-1.3 4.4-1.8 1.9-.4 3.5-.7 5-.7h27.1c3.5.0 5.7.1 6.8.6 1.3.5 2.3 1.1 3.1 1.9.9.8 1.5 1.7 2 2.7.4.8.6 3.3.6 7.4l.2 16.7c0 8.1-.1 13.6-.3 16.7zM265.4 23.3v40h31.2v-40h-31.2z"/></g><g class="st0"><path class="st1" d="M316.2 73.4v-60l31.3.3c2.5.0 5.4.6 8.7 1.9 2.6 1 4.8 2.4 6.6 4.3 2 2 3.4 4.2 4.3 6.6 1 3 1.5 5.9 1.5 8.7v17.3c0 3.2-.5 6.1-1.5 8.7s-2.4 4.8-4.2 6.6-4 3.2-6.6 4.2-5.5 1.5-8.7 1.5h-31.3zm30.7-11.2c4.9.0 8-.7 9.2-2 2.1-2.3 3.2-5.8 3.2-10.4v-14c.2-1.9-.2-3.6-1.1-5.2-.8-1.5-1.8-2.8-2.9-3.9-1.1-1.1-2.4-1.9-3.9-2.4-1.5-.6-3-.8-4.4-.8h-21.3v38.8h21.2z"/><path class="st1" d="M381 13.4h45l-1.4 10.3-33.8-.2v13.6l20.1-.2v11.4h-20.1v13.5h33.4l1.8 11.6h-45v-60z"/><path class="st1" d="M446.4 46.5c-1.1.0-2.2-.3-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7-.4-1-.7-2.2-.7-3.3V22.1c0-1.2.2-2.3.7-3.3s1.1-2 1.8-2.7 1.7-1.4 2.8-1.8 2.2-.7 3.3-.7h29.1c1.2.0 2.3.2 3.3.7s1.9 1.1 2.7 1.8c1.1 1 1.7 2 1.8 2.8l.7 3.3v6.7l-9 2.7v-7.7h-28.7v14.3l29.1.5c1.2.0 2.3.3 3.3.7 1.1.4 2 1.1 2.8 1.8.8.8 1.4 1.7 1.8 2.7.4 1 .7 2.2.7 3.3V65c0 1.2-.2 2.3-.7 3.3-.4 1-1.1 2-1.8 2.7-.8.8-1.7 1.4-2.7 1.8-1 .4-2.1.7-3.3.7h-30c-1.2.0-2.3-.2-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7-.4-1-.7-2.2-.7-3.3v-7.7l9.5-1.6v7.7h28.7V47.2l-28.7-.5z"/><path class="st1" d="M505.4 13.4v23.9l26.2-23.9h12.9l-30.8 27.4 32.1 32.6h-12.9l-27.5-28.1v28.1h-10.6v-60h10.6z"/></g></svg></span></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=main_navbar><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://neurodesk.org/overview/><span>Overview</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://neurodesk.org/getting-started/><span>Getting Started</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://neurodesk.org/tutorials-examples/><span>Tutorials & Examples</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class="nav-link active" href=https://neurodesk.org/developers/><span class=active>Developer Documentation</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/NeuroDesk target=_blank><span>GitHub</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://neurodesk.org/contact/><span>Contact</span></a></li></ul><div class="navbar-nav d-lg-block"><div class=td-search><div class=td-search--algolia id=docsearch-0></div></div></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=https://neurodesk.org/developers/interfacing/>Return to the regular view of this page</a>.</p></div><h1 class=title>Interfacing</h1><div class=lead>Section to describe programmatic interfaces to Neurodesk</div><ul></ul><div class=content><h1 id=connectingattaching-to-a-running-neurodesktop-session-via-a-plain-shell>Connecting/attaching to a running Neurodesktop session via a plain shell</h1><p>You can start a neurodesktop container using docker or the neurodeskapp. If you want to connect to this running session using a shell you can do this as well:</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>docker ps
</span></span><span style=display:flex><span># note the name of the running container, e.g. neurodeskapp-49977
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># now connect to this container
</span></span><span style=display:flex><span>docker exec --user=jovyan -ti neurodeskapp-49977 bash</span></span></code></pre></div></div><h1 id=api-interface-to-jupyter>API interface to Jupyter</h1><p>This currently does not work on Apple Silicon Machines!</p><p>Install necessary tools, e.g. for MacOS</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>brew install coreutils
</span></span><span style=display:flex><span>brew install websocat</span></span></code></pre></div></div><p>or for linux:</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>wget https<span style=color:#1f2328>:</span><span style=color:#0550ae>//</span>github<span style=color:#0550ae>.</span>com<span style=color:#0550ae>/</span>vi<span style=color:#0550ae>/</span>websocat<span style=color:#0550ae>/</span>releases<span style=color:#0550ae>/</span>download<span style=color:#0550ae>/</span>v1<span style=color:#0550ae>.</span><span style=color:#0550ae>12.0</span><span style=color:#0550ae>/</span>websocat<span style=color:#0550ae>.</span>x86_64<span style=color:#0550ae>-</span>unknown<span style=color:#0550ae>-</span>linux<span style=color:#0550ae>-</span>musl
</span></span><span style=display:flex><span>chmod <span style=color:#0550ae>+</span>x websocat<span style=color:#0550ae>.</span>x86_64<span style=color:#0550ae>-</span>unknown<span style=color:#0550ae>-</span>linux<span style=color:#0550ae>-</span>musl
</span></span><span style=display:flex><span>sudo mv websocat<span style=color:#0550ae>.</span>x86_64<span style=color:#0550ae>-</span>unknown<span style=color:#0550ae>-</span>linux<span style=color:#0550ae>-</span>musl <span style=color:#0550ae>/</span>usr<span style=color:#0550ae>/</span>local<span style=color:#0550ae>/</span>bin<span style=color:#0550ae>/</span>websocat
</span></span><span style=display:flex><span>apt install jq</span></span></code></pre></div></div><p>Start a jupyter notebook session, e.g. on EXAMPLE_API_URL=play-europe.neurodesk.org</p><p>Then open a terminal in jupyter and find your jupyterhub token and your username:</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>echo JUPYTERHUB_USER=$JUPYTERHUB_USER
</span></span><span style=display:flex><span>echo JPY_API_TOKEN=$JPY_API_TOKEN</span></span></code></pre></div></div><p>Now you can interface with Jupyter through:</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>USER=$JUPYTERHUB_USER
</span></span><span style=display:flex><span>USER_TOKEN=$JPY_API_TOKEN
</span></span><span style=display:flex><span>API_URL=$EXAMPLE_API_URL
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TERMINAL_RESPONSE=$(curl -k -s -X POST \
</span></span><span style=display:flex><span>    -H &#34;Authorization: token $USER_TOKEN&#34; \
</span></span><span style=display:flex><span>    &#34;https://$API_URL/user/$USER/api/terminals&#34; || echo &#39;{&#34;error&#34;: &#34;curl_failed&#34;}&#39;)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo &#34;Terminal API response: $TERMINAL_RESPONSE&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TERMINAL_NAME=$(echo &#34;$TERMINAL_RESPONSE&#34; | jq -r &#39;.name // empty&#39;)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>if [ -n &#34;$TERMINAL_NAME&#34; ] &amp;&amp; [ &#34;$TERMINAL_NAME&#34; != &#34;null&#34; ] &amp;&amp; [ &#34;$TERMINAL_NAME&#34; != &#34;empty&#34; ]; then
</span></span><span style=display:flex><span>    echo &#34;✅ Terminal created successfully: $TERMINAL_NAME&#34;
</span></span><span style=display:flex><span>else
</span></span><span style=display:flex><span>    echo &#34;❌ Terminal creation failed&#34;
</span></span><span style=display:flex><span>    echo &#34;Full response: $TERMINAL_RESPONSE&#34;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    # more info about the user
</span></span><span style=display:flex><span>    echo &#34;Checking user info...&#34;
</span></span><span style=display:flex><span>    USER_INFO=$(curl -k -s -H &#34;Authorization: token $USER_TOKEN&#34; &#34;https://$API_URL/hub/api/users/$USER&#34; || echo &#39;{&#34;error&#34;: &#34;failed&#34;}&#39;)
</span></span><span style=display:flex><span>    echo &#34;User info: $USER_INFO&#34;
</span></span><span style=display:flex><span>fi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Function to test WebSocket connection
</span></span><span style=display:flex><span>test_websocket_connection() {
</span></span><span style=display:flex><span>    local token=&#34;$1&#34;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    echo &#34;Testing WebSocket connection...&#34;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    # Test connection
</span></span><span style=display:flex><span>    WS_TEST=$(echo &#39;[&#34;stdin&#34;, &#34;echo test_connection\r\n&#34;]&#39; | \
</span></span><span style=display:flex><span>        timeout 15 websocat --text &#34;wss://$API_URL/user/$USER/terminals/websocket/$TERMINAL_NAME&#34; \
</span></span><span style=display:flex><span>        -H &#34;Authorization: token $token&#34; 2&gt;&amp;1 | head -10)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    if [ $? -eq 0 ] &amp;&amp; [ -n &#34;$WS_TEST&#34; ]; then
</span></span><span style=display:flex><span>        echo &#34;WebSocket response: $WS_TEST&#34;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # Check if we got expected output format
</span></span><span style=display:flex><span>        if echo &#34;$WS_TEST&#34; | grep -q &#39;\[&#34;stdout&#34;&#39;; then
</span></span><span style=display:flex><span>            echo &#34;✅ WebSocket connection successful with proper output format&#34;
</span></span><span style=display:flex><span>            return 0
</span></span><span style=display:flex><span>        elif echo &#34;$WS_TEST&#34; | grep -q &#39;test_connection&#39;; then
</span></span><span style=display:flex><span>            echo &#34;✅ WebSocket connection successful&#34;
</span></span><span style=display:flex><span>            return 0
</span></span><span style=display:flex><span>        else
</span></span><span style=display:flex><span>            echo &#34;⚠️ WebSocket connected but unexpected format&#34;
</span></span><span style=display:flex><span>            echo &#34;Raw output: $WS_TEST&#34;
</span></span><span style=display:flex><span>            return 1
</span></span><span style=display:flex><span>        fi
</span></span><span style=display:flex><span>    else
</span></span><span style=display:flex><span>        echo &#34;❌ WebSocket connection failed&#34;
</span></span><span style=display:flex><span>        echo &#34;Error: $WS_TEST&#34;
</span></span><span style=display:flex><span>        return 1
</span></span><span style=display:flex><span>    fi
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Test with user token
</span></span><span style=display:flex><span>if test_websocket_connection &#34;$USER_TOKEN&#34;; then
</span></span><span style=display:flex><span>    echo &#34;✅ WebSocket connection working with user token&#34;
</span></span><span style=display:flex><span>else
</span></span><span style=display:flex><span>    echo &#34;❌ WebSocket connection failed&#34;
</span></span><span style=display:flex><span>    echo &#34;&#34;
</span></span><span style=display:flex><span>    echo &#34;🔍 Additional debugging info:&#34;
</span></span><span style=display:flex><span>    echo &#34;- Terminal exists: $TERMINAL_NAME&#34;
</span></span><span style=display:flex><span>    echo &#34;- User token: ${USER_TOKEN}...&#34;
</span></span><span style=display:flex><span>    echo &#34;- API accessible: $(curl -k -s -o /dev/null -w &#34;%{http_code}&#34; &#34;$API_URL&#34;)&#34;
</span></span><span style=display:flex><span>    echo &#34;- WebSocket URL: ws://$API_URL/user/$USER/terminals/websocket/$TERMINAL_NAME&#34;
</span></span><span style=display:flex><span>fi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Function to send command and get response
</span></span><span style=display:flex><span>send_command() {
</span></span><span style=display:flex><span>    local cmd=&#34;$1&#34;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    echo &#34;Testing command: $cmd&#34;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    local clean_api_url=${API_URL#*//}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    local output=&#34;&#34;
</span></span><span style=display:flex><span>    for attempt in {1..3}; do
</span></span><span style=display:flex><span>        echo &#34;  Attempt $attempt...&#34;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        echo &#34;$ $cmd&#34;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # Send command
</span></span><span style=display:flex><span>        echo &#34;[\&#34;stdin\&#34;, \&#34;$cmd\\r\\n\&#34;]&#34; | \
</span></span><span style=display:flex><span>            timeout 15 websocat --text \
</span></span><span style=display:flex><span>            &#34;wss://$clean_api_url/user/$USER/terminals/websocket/$TERMINAL_NAME&#34; \
</span></span><span style=display:flex><span>            -H &#34;Authorization: token $USER_TOKEN&#34;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        sleep 10
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # get the terminal output
</span></span><span style=display:flex><span>        local output=$(echo &#39;[&#34;stdin&#34;, &#34;&#34;]&#39; | \
</span></span><span style=display:flex><span>            timeout 15 websocat --text \
</span></span><span style=display:flex><span>            &#34;wss://$clean_api_url/user/$USER/terminals/websocket/$TERMINAL_NAME&#34; \
</span></span><span style=display:flex><span>            -H &#34;Authorization: token $USER_TOKEN&#34;)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        if [ -n &#34;$output&#34; ]; then
</span></span><span style=display:flex><span>            echo &#34;$output&#34; | \
</span></span><span style=display:flex><span>            grep &#39;^\[&#34;stdout&#34;&#39; | \
</span></span><span style=display:flex><span>            sed &#39;s/^\[&#34;stdout&#34;, *&#34;//; s/&#34;\]$//&#39; | \
</span></span><span style=display:flex><span>            sed &#39;s/\\u001b\[[?]*[0-9;]*[a-zA-Z]//g; s/\\r\\n/\n/g; s/\\r/\n/g&#39; | \
</span></span><span style=display:flex><span>            # sed -n &#34;/\$ $cmd/,/\$ /p&#34; | \
</span></span><span style=display:flex><span>            sed &#39;1d; $d&#39; | \
</span></span><span style=display:flex><span>            grep -v &#34;^$&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            return 0
</span></span><span style=display:flex><span>        fi
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        echo &#34;(no output), response: ${output}&#34;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        sleep 2
</span></span><span style=display:flex><span>    done
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    echo &#34;  ❌ Command failed after 3 attempts&#34;
</span></span><span style=display:flex><span>    echo &#34;  Output: $output&#34;
</span></span><span style=display:flex><span>    return 1
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>send_command &#34;touch test3.txt&#34;
</span></span><span style=display:flex><span>send_command &#34;ls&#34;
</span></span><span style=display:flex><span>send_command &#34;ml fsl; fslmaths&#34;
</span></span><span style=display:flex><span>send_command &#34;pwd&#34;
</span></span><span style=display:flex><span>send_command &#34;ml ants; antsRegistration&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># To start an interactive terminal session
</span></span><span style=display:flex><span>interactive_terminal() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    local clean_api_url=${API_URL#*//}
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    echo &#34;=== Interactive Terminal Started ===&#34;
</span></span><span style=display:flex><span>    echo &#34;Type &#39;exit&#39; to quit&#34;
</span></span><span style=display:flex><span>    echo &#34;==================================&#34;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    while true; do
</span></span><span style=display:flex><span>        echo -n &#34;$ &#34;
</span></span><span style=display:flex><span>        read -r user_cmd
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # Exit condition
</span></span><span style=display:flex><span>        if [[ &#34;$user_cmd&#34; == &#34;exit&#34; ]]; then
</span></span><span style=display:flex><span>            echo &#34;Terminal session ended.&#34;
</span></span><span style=display:flex><span>            break
</span></span><span style=display:flex><span>        fi
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # Skip empty commands
</span></span><span style=display:flex><span>        if [[ -z &#34;$user_cmd&#34; ]]; then
</span></span><span style=display:flex><span>            continue
</span></span><span style=display:flex><span>        fi
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        echo &#34;Executing: $user_cmd&#34;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # Send command
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        echo &#34;[\&#34;stdin\&#34;, \&#34;$user_cmd\\r\\n\&#34;]&#34; | \
</span></span><span style=display:flex><span>            timeout 15 websocat --text \
</span></span><span style=display:flex><span>            &#34;wss://$clean_api_url/user/$USER/terminals/websocket/$TERMINAL_NAME&#34; \
</span></span><span style=display:flex><span>            -H &#34;Authorization: token $USER_TOKEN&#34; 
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        sleep 10
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # get the terminal output
</span></span><span style=display:flex><span>        local output=$(echo &#39;[&#34;stdin&#34;, &#34;&#34;]&#39; | \
</span></span><span style=display:flex><span>            timeout 15 websocat --text \
</span></span><span style=display:flex><span>            &#34;wss://$clean_api_url/user/$USER/terminals/websocket/$TERMINAL_NAME&#34; \
</span></span><span style=display:flex><span>            -H &#34;Authorization: token $USER_TOKEN&#34;)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        if [ -n &#34;$output&#34; ]; then
</span></span><span style=display:flex><span>            echo &#34;$output&#34; | \
</span></span><span style=display:flex><span>            grep &#39;^\[&#34;stdout&#34;&#39; | \
</span></span><span style=display:flex><span>            sed &#39;s/^\[&#34;stdout&#34;, *&#34;//; s/&#34;\]$//&#39; | \
</span></span><span style=display:flex><span>            sed &#39;s/\\u001b\[[?]*[0-9;]*[a-zA-Z]//g; s/\\r\\n/\n/g; s/\\r/\n/g&#39; | \
</span></span><span style=display:flex><span>            # sed -n &#34;/\$ $user_cmd/,/\$ /p&#34; | \
</span></span><span style=display:flex><span>            sed &#39;1d; $d&#39; | \
</span></span><span style=display:flex><span>            grep -v &#34;^$&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        else
</span></span><span style=display:flex><span>            echo &#34;(output error, response:)  ${output}&#34;
</span></span><span style=display:flex><span>        fi
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        echo &#34;&#34; 
</span></span><span style=display:flex><span>    done
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>interactive_terminal</span></span></code></pre></div></div></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Mastodon aria-label=Mastodon><a target=_blank rel=noopener href=https://masto.ai/@Neurodesk aria-label=Mastodon><i class="fab fa-mastodon responsive-icon"></i>&nbsp;&nbsp;Mastodon</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/NeuroDesk/discussions aria-label=Discussion><i class="fa fa-envelope responsive-icon"></i>&nbsp;&nbsp;Discussion</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Acknowledgements aria-label=Acknowledgements><a target=_blank rel=noopener href=https://neurodesk.org/overview/acknowledgement/ aria-label=Acknowledgements><i class="fa fa-handshake responsive-icon"></i>&nbsp;&nbsp;Acknowledgements</a></li></ul></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Metrics aria-label=Metrics><a target=_blank rel=noopener href=https://neurodesk.org/docs/overview/metrics aria-label=Metrics><i class="fa fa-signal responsive-icon"></i>&nbsp;&nbsp;Metrics</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Uptime aria-label=Uptime><a target=_blank rel=noopener href=https://stats.uptimerobot.com/NBE38IZWZM aria-label=Uptime><i class="fa fa-circle responsive-icon"></i>&nbsp;&nbsp;Uptime</a></li></ul></div><div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://neurodesk.org/js/main.min.371147b5f79a80912e5b0a2cd8f59889c6f0ac501947707b50f470099ce2141c.js integrity="sha256-NxFHtfeagJEuWwos2PWYicbwrFAZR3B7UPRwCZziFBw=" crossorigin=anonymous></script><script defer src=https://neurodesk.org/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3.8.2 integrity="sha512-lsD+XVzdBI6ZquXc8gqbw0/bgrfIsMJwY/8xvmvbN+U3gZSeG7BXQoCq4zv/yCmntR2GLHtgB+bD4ESPsKIbIA==" crossorigin=anonymous></script><script type=text/javascript>const containers=["#docsearch-0","#docsearch-1"];for(let e of containers)docsearch({container:e,appId:"P5JEPQ5LZ2",apiKey:"56c6d9a954f7df2a98dcedb2763af8c4",indexName:"neurodesk"})</script><script src=https://neurodesk.org/js/tabpane-persist.js></script></body></html>